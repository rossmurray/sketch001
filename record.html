<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>record</title>
  <style>
  html {
    height: 100%;
    width: 100%;
  }
  body {
    width: 100%;
    height: 100%;
    margin: 0px;
    border: 0;
  }
  canvas#main {
    position: absolute;
    left: 0px;
    top: 40px;
  }
  </style>
</head>
  <script src="lib/pixi.min.js"></script>
  <script src="lib/anime.min.js"></script>
  <script src="lib/chroma.min.js"></script>
  <script src="lib/CCapture.all.min.js"></script>
<body>
    <button id="startButton">Start</button>
  <button id="recordButton">Record</button>
  <button id="bothButton">Both</button>
  <p id="progress" style="display: inline;">0%</p>
  <canvas id="main"></canvas>
  <script type="text/javascript">
    (function(){
      const canvas = document.getElementById('main');
      canvas.width = 800;
      canvas.height = 600;
    })();
  </script>
  <script type="text/javascript">
    (function() {
      const captureConfig = {
        framerate: 60,
        format: 'webm',
        timeLimit: 5,
      };
      const recorder = new CCapture(captureConfig);
      const canvas = document.getElementById('main');
      const recordButton = document.getElementById('recordButton');
      recordButton.onclick = function() {
        recorder.start();
        setTimeout(progress, 100);
      };
      const startButton = document.getElementById('startButton');
      startButton.onclick = function() {
        window.fnMain(recorder)
      };
      const bothButton = document.getElementById('bothButton');
      bothButton.onclick = function() {
        window.fnMain(recorder);
        setTimeout(function(){
          recorder.start();
          setTimeout(progress, 100);
        }, 100);
      };
      let timePassed = 0;
      const progel = document.getElementById('progress');
      function progress() {
        timePassed += 100;
        progel.innerHTML = "" + +(timePassed / 1000).toFixed(2);
        setTimeout(progress, 100);
      }
    })();
  </script>
  <script type="text/javascript" src="main.js"></script>
</body>
</html>